From faac8df2453f43280a89d43a34c52e50c3995c7e Mon Sep 17 00:00:00 2001
From: aniruddhgutta <aniruddhgutta@disroot.org>
Date: Sat, 18 Oct 2025 15:36:49 +0530
Subject: [PATCH 07/16] compiler-rt-HACK-always-compile-in-gcc_personality_v

---
 compiler-rt/lib/builtins/CMakeLists.txt       | 10 ++++------
 compiler-rt/lib/builtins/gcc_personality_v0.c |  2 +-
 2 files changed, 5 insertions(+), 7 deletions(-)

diff --git a/compiler-rt/lib/builtins/CMakeLists.txt b/compiler-rt/lib/builtins/CMakeLists.txt
index 99e330a1c..91f24886f 100644
--- a/compiler-rt/lib/builtins/CMakeLists.txt
+++ b/compiler-rt/lib/builtins/CMakeLists.txt
@@ -233,12 +233,10 @@ if(APPLE)
   )
 endif()
 
-if (HAVE_UNWIND_H)
-  set(GENERIC_SOURCES
-    ${GENERIC_SOURCES}
-    gcc_personality_v0.c
-  )
-endif ()
+set(GENERIC_SOURCES
+  ${GENERIC_SOURCES}
+  gcc_personality_v0.c
+)
 
 if (NOT FUCHSIA)
   set(GENERIC_SOURCES
diff --git a/compiler-rt/lib/builtins/gcc_personality_v0.c b/compiler-rt/lib/builtins/gcc_personality_v0.c
index ef63a5fb8..5a0a90b38 100644
--- a/compiler-rt/lib/builtins/gcc_personality_v0.c
+++ b/compiler-rt/lib/builtins/gcc_personality_v0.c
@@ -9,7 +9,7 @@
 #include "int_lib.h"
 #include <stddef.h>
 
-#include <unwind.h>
+#include "../../../libunwind/include/unwind.h"
 #if defined(__arm__) && !defined(__ARM_DWARF_EH__) &&                          \
     !defined(__USING_SJLJ_EXCEPTIONS__)
 // When building with older compilers (e.g. clang <3.9), it is possible that we
-- 
2.51.0

